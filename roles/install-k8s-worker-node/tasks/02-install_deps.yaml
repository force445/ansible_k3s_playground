---
- name: Check if containerd config exists
  stat:
    path: /etc/containerd/config.toml
  register: containerd_config_file

- name: Update apt cache
  apt:
    update_cache: yes

- name: Install Kubernetes packages
  apt:
    name:
      - kubelet
      - kubeadm
      - kubectl
    state: present

- name: Hold Kubernetes packages to prevent unintended upgrades
  shell: apt-mark hold kubelet kubeadm kubectl